song=$1
start=$2
stop=$3
tmpf=$$.mp3
while true; do
  [ "$start" ] || start=0
  [ "$stop" ] || stop=120
  let duration=$stop-$start
  set -x
  ffmpeg -i $song -ss $start -t $duration -qscale:a 8 $tmpf
  set +x
  play $tmpf

  PS3="Select next option: "
  select ans in Save-Intro Save Redo Quit; do
    break
  done
  case $ans in
    Save-Intro)
      echo "Saving to intro-$song"
      mv $tmpf intro-$song
      break
      ;;
    Save)
      echo "Enter prefix to save (intro, solo, p0, ...)"
      read ans
      if [ "$ans" ]; then
        mv $tmpf $ans-$song
        break
      fi
      ;;
    Redo)
      /bin/echo -n "Enter new value for start/stop: "
      read start stop
      rm -f $tmpf
      ;;
    *)
      rm -f $tmpf
      break
      ;;
  esac
done
